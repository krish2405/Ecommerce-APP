{% extends "base.html" %}
{% block title %}Cart{% endblock %}
{% block content %}
<h2>Your Cart</h2>
{% if cart.items %}
<ul class="list-group">
    <li class="list-group-item d-flex justify-content-between">
        <strong>Product</strong>
        <strong>Quantity</strong>
        <strong>Price</strong>  
        <strong> </strong>
    </li>
  {% for item in cart.items %}
  <li class="list-group-item d-flex justify-content-between align-items-center">
    <span>{{ item.product.name }}</span>
    
    <!-- Quantity change form -->
    <form method="post" action="{% url 'update_cart_item' %}" class="d-flex align-items-center">
        {% csrf_token %}
        <input type="hidden" name="cart_id" value="{{ item.id }}">
        <input type="hidden" name="product_id" value="{{ item.product.id }}">
        <input type="number" 
               name="quantity" 
               value="{{ item.quantity }}" 
               min="1" 
               class="form-control form-control-sm"
               style="width:70px;"
               onchange="this.form.submit()">
    </form>
    
    <span>₹{{ item.product.price|floatformat:2 }}</span>
    
    <!-- Remove button -->
    <form method="post" action="{% url 'remove_from_cart' %}">
        {% csrf_token %}
        <input type="hidden" name="cart_id" value="{{ item.id }}">
        <button class="btn btn-danger btn-sm">Remove</button>       
    </form>
  </li>
  {% endfor %}
</ul>

<div class="mt-3">
  <h4>Total: ₹{{ cart.total_price }}</h4>
    <form method="post" action="{% url 'checkout' %}">
        {% csrf_token %}
        <button class="btn btn-primary">Checkout</button>       
    </form>
</div>
{% else %}
<p>Your cart is empty.</p>
{% endif %}
{% endblock %}
